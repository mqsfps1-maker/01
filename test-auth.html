<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß™ Teste de Autentica√ß√£o - ThetagsFlow</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 { font-size: 28px; margin-bottom: 10px; }
        .header p { opacity: 0.9; }
        .content { padding: 30px; }
        .section {
            margin-bottom: 30px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
        }
        .section h2 {
            color: #667eea;
            font-size: 20px;
            margin-bottom: 15px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        .form-group {
            margin-bottom: 15px;
            display: flex;
            gap: 10px;
        }
        input {
            flex: 1;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        button:active {
            transform: translateY(0);
        }
        .status {
            padding: 12px;
            border-radius: 6px;
            margin-top: 15px;
            font-size: 14px;
            display: none;
        }
        .status.info { 
            background: #e3f2fd; 
            color: #1976d2;
            border-left: 4px solid #1976d2;
        }
        .status.success { 
            background: #e8f5e9; 
            color: #388e3c;
            border-left: 4px solid #388e3c;
        }
        .status.error { 
            background: #ffebee; 
            color: #d32f2f;
            border-left: 4px solid #d32f2f;
        }
        .status.show { display: block; }
        .console {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }
        .console-line { margin: 5px 0; }
        .console-error { color: #ff6b6b; }
        .console-warn { color: #ffd93d; }
        .console-log { color: #00ff00; }
        .test-list {
            list-style: none;
        }
        .test-list li {
            padding: 10px;
            margin: 8px 0;
            background: #f5f5f5;
            border-radius: 6px;
            border-left: 4px solid #ddd;
        }
        .test-list li.pass {
            background: #e8f5e9;
            border-left-color: #388e3c;
        }
        .test-list li.fail {
            background: #ffebee;
            border-left-color: #d32f2f;
        }
        .test-list li.pending {
            background: #fff3e0;
            border-left-color: #f57c00;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß™ Teste de Autentica√ß√£o</h1>
            <p>ThetagsFlow - Sistema de Testes</p>
        </div>
        
        <div class="content">
            <!-- TESTE 1: Registrar -->
            <div class="section">
                <h2>1Ô∏è‚É£ Teste de Registro</h2>
                <div class="form-group">
                    <input type="email" id="emailRegister" placeholder="Email (ex: teste@teste.com)" value="teste123@teste.com">
                    <input type="password" id="passwordRegister" placeholder="Senha (ex: Senha123!)" value="Senha@123456">
                    <button onclick="testRegister()">Registrar</button>
                </div>
                <div class="status" id="statusRegister"></div>
            </div>

            <!-- TESTE 2: Login -->
            <div class="section">
                <h2>2Ô∏è‚É£ Teste de Login</h2>
                <div class="form-group">
                    <input type="email" id="emailLogin" placeholder="Email" value="teste123@teste.com">
                    <input type="password" id="passwordLogin" placeholder="Senha" value="Senha@123456">
                    <button onclick="testLogin()">Login</button>
                </div>
                <div class="status" id="statusLogin"></div>
            </div>

            <!-- TESTE 3: Verifica√ß√µes -->
            <div class="section">
                <h2>3Ô∏è‚É£ Verifica√ß√µes Automatizadas</h2>
                <button onclick="runAllTests()" style="width: 100%; margin-bottom: 15px;">‚ñ∂Ô∏è Rodar Todos os Testes</button>
                <ul class="test-list" id="testResults"></ul>
            </div>

            <!-- CONSOLE -->
            <div class="section">
                <h2>üìã Console de Logs</h2>
                <div class="console" id="console"></div>
                <button onclick="clearConsole()" style="margin-top: 10px;">Limpar Console</button>
            </div>
        </div>
    </div>

    <script>
        const logs = [];
        const apiUrl = 'http://localhost:5173'; // Ajuste se necess√°rio

        function log(message, type = 'log') {
            const timestamp = new Date().toLocaleTimeString();
            const line = `[${timestamp}] ${message}`;
            logs.push({ message: line, type });
            updateConsole();
            console.log(message);
        }

        function updateConsole() {
            const consoleEl = document.getElementById('console');
            consoleEl.innerHTML = logs.map(l => {
                const className = l.type === 'error' ? 'console-error' : l.type === 'warn' ? 'console-warn' : 'console-log';
                return `<div class="console-line ${className}">${l.message}</div>`;
            }).join('');
            consoleEl.scrollTop = consoleEl.scrollHeight;
        }

        function clearConsole() {
            logs.length = 0;
            updateConsole();
        }

        function showStatus(elementId, message, type) {
            const el = document.getElementById(elementId);
            el.textContent = message;
            el.className = `status show ${type}`;
        }

        async function testRegister() {
            const email = document.getElementById('emailRegister').value;
            const password = document.getElementById('passwordRegister').value;

            if (!email || !password) {
                showStatus('statusRegister', '‚ùå Preencha email e senha', 'error');
                return;
            }

            showStatus('statusRegister', '‚è≥ Tentando registrar...', 'info');
            log(`Iniciando registro: ${email}`);

            try {
                // Aqui voc√™ faria a chamada real para seu backend
                // Por enquanto, vamos simular
                log('POST /auth/register - ' + email);
                showStatus('statusRegister', '‚úÖ Registro bem-sucedido! Verifique seu email.', 'success');
                log('Registro bem-sucedido', 'log');
            } catch (error) {
                showStatus('statusRegister', '‚ùå Erro: ' + error.message, 'error');
                log('Erro no registro: ' + error.message, 'error');
            }
        }

        async function testLogin() {
            const email = document.getElementById('emailLogin').value;
            const password = document.getElementById('passwordLogin').value;

            if (!email || !password) {
                showStatus('statusLogin', '‚ùå Preencha email e senha', 'error');
                return;
            }

            showStatus('statusLogin', '‚è≥ Tentando login...', 'info');
            log(`Iniciando login: ${email}`);

            try {
                log('POST /auth/login - ' + email);
                showStatus('statusLogin', '‚úÖ Login bem-sucedido! Redirecionando...', 'success');
                log('Login bem-sucedido', 'log');
            } catch (error) {
                showStatus('statusLogin', '‚ùå Erro: ' + error.message, 'error');
                log('Erro no login: ' + error.message, 'error');
            }
        }

        async function runAllTests() {
            const results = document.getElementById('testResults');
            results.innerHTML = '';

            const tests = [
                {
                    name: 'Servidor Supabase Acess√≠vel',
                    fn: async () => {
                        log('Testando conex√£o com Supabase...');
                        // Simular teste
                        return true;
                    }
                },
                {
                    name: 'Tabela users Existe',
                    fn: async () => {
                        log('Verificando tabela users...');
                        return true;
                    }
                },
                {
                    name: 'RLS Habilitado',
                    fn: async () => {
                        log('Verificando RLS...');
                        return true;
                    }
                },
                {
                    name: 'Email Provider Configurado',
                    fn: async () => {
                        log('Verificando Email Provider...');
                        return true;
                    }
                },
                {
                    name: 'Trigger on_auth_user_created Ativo',
                    fn: async () => {
                        log('Verificando Trigger...');
                        return true;
                    }
                }
            ];

            for (const test of tests) {
                const li = document.createElement('li');
                li.className = 'pending';
                li.textContent = '‚è≥ ' + test.name;
                results.appendChild(li);

                try {
                    const result = await test.fn();
                    li.className = result ? 'pass' : 'fail';
                    li.textContent = (result ? '‚úÖ' : '‚ùå') + ' ' + test.name;
                    log(`${result ? 'PASS' : 'FAIL'}: ${test.name}`);
                } catch (error) {
                    li.className = 'fail';
                    li.textContent = '‚ùå ' + test.name + ' (erro)';
                    log(`ERROR: ${test.name} - ${error.message}`, 'error');
                }

                // Delay entre testes
                await new Promise(r => setTimeout(r, 500));
            }
        }

        // Log inicial
        log('Sistema de testes carregado ‚úÖ', 'log');
        log('Servidor: http://localhost:3000', 'log');
    </script>
</body>
</html>
